<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MWERCOINS - Discover New Crypto Tokens</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --success-color: #2ecc71;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: var(--dark-color);
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.8rem;
            color: white !important;
        }
        
        .btn-mwer {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }
        
        .btn-mwer:hover {
            background-color: #c0392b;
            border-color: #c0392b;
            color: white;
        }
        
        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1);
        }
        
        .token-img {
            width: 50px;
            height: 50px;
            object-fit: contain;
            border-radius: 50%;
            background-color: #f0f0f0;
        }
        
        .badge-network {
            font-size: 0.75rem;
            padding: 0.35em 0.65em;
        }
        
        .solana {
            background-color: #9945FF;
            color: white;
        }
        
        .ethereum {
            background-color: #627EEA;
            color: white;
        }
        
        .bnb {
            background-color: #F3BA2F;
            color: black;
        }
        
        .modal-content {
            border-radius: 12px;
            border: none;
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
        }
        
        .token-detail-img {
            width: 100px;
            height: 100px;
            object-fit: contain;
            border-radius: 50%;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            background-color: #f0f0f0;
        }
        
        .address-container {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 10px 15px;
            font-family: monospace;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .copy-btn {
            cursor: pointer;
            transition: color 0.2s;
            margin-left: 10px;
        }
        
        .copy-btn:hover {
            color: var(--secondary-color);
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 0 0 20px 20px;
            padding: 3rem 0;
            margin-bottom: 2rem;
        }
        
        .upload-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
            z-index: 1000;
        }
        
        .preview-image {
            max-width: 100px;
            max-height: 100px;
            margin-top: 10px;
            border-radius: 8px;
            display: none;
            background-color: #f0f0f0;
        }
        
        .visitor-counter {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-top: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .counter-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }
        
        .brand-highlight {
            color: var(--accent-color);
            font-weight: bold;
        }
        
        .developer-credit {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background-color: var(--light-color);
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .developer-link {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
        }
        
        .developer-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">
                <span class="brand-highlight">MWER</span>COINS
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#uploadModal">Upload Token</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-3">Discover New Crypto Tokens</h1>
            <p class="lead mb-4">Explore community-uploaded tokens on <span class="brand-highlight">MWERCOINS</span> platform</p>
            <button class="btn btn-light btn-lg px-4" data-bs-toggle="modal" data-bs-target="#uploadModal">
                <i class="fas fa-plus me-2"></i>Upload Your Token
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mb-5">
        <div class="row mb-4">
            <div class="col-md-6">
                <h2 class="fw-bold">Recently Added Tokens</h2>
            </div>
            <div class="col-md-6 text-end">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search tokens..." id="searchInput">
                    <button class="btn btn-mwer" type="button" onclick="searchTokens()">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="row" id="tokenList">
            <!-- Tokens will be loaded here -->
        </div>

        <!-- Visitor Counter -->
        <div class="visitor-counter">
            <p>This website has been visited <span class="counter-number" id="visitorCount">0</span> times</p>
        </div>

        <!-- Developer Credit -->
        <div class="developer-credit">
            <p>DEVELOPER / <span class="developer-link" onclick="window.location.href='https://werr13str.netlify.app/'">werr13str</span></p>
        </div>
    </div>

    <!-- Floating Upload Button -->
    <button class="btn btn-mwer upload-btn" data-bs-toggle="modal" data-bs-target="#uploadModal">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Upload Token Modal -->
    <div class="modal fade" id="uploadModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Upload New Token to MWERCOINS</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="tokenForm">
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3"><span class="badge bg-primary me-2">1</span> Token Basic Information</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="tokenName" class="form-label">Token Name</label>
                                    <input type="text" class="form-control" id="tokenName" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="tokenImage" class="form-label">Token Image</label>
                                    <input type="file" class="form-control" id="tokenImage" accept="image/*" onchange="previewImage(this)">
                                    <img id="imagePreview" class="preview-image" alt="Token preview">
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3"><span class="badge bg-primary me-2">2</span> Blockchain Details</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="tokenNetwork" class="form-label">Blockchain Network</label>
                                    <select class="form-select" id="tokenNetwork" required>
                                        <option value="" selected disabled>Select network</option>
                                        <option value="solana">Solana</option>
                                        <option value="ethereum">Ethereum</option>
                                        <option value="bnb">BNB Chain</option>
                                        <option value="polygon">Polygon</option>
                                        <option value="avalanche">Avalanche</option>
                                        <option value="arbitrum">Arbitrum</option>
                                        <option value="optimism">Optimism</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="tokenAddress" class="form-label">Token Address</label>
                                    <input type="text" class="form-control" id="tokenAddress" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3"><span class="badge bg-primary me-2">3</span> Additional Information</h6>
                            <div class="mb-3">
                                <label for="tokenDescription" class="form-label">Description</label>
                                <textarea class="form-control" id="tokenDescription" rows="3" required></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="tokenCreator" class="form-label">Creator/Developer</label>
                                <input type="text" class="form-control" id="tokenCreator" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-mwer" id="uploadTokenBtn">Upload Token</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Token Detail Modal -->
    <div class="modal fade" id="tokenDetailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold" id="detailTokenName"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img src="" alt="Token Image" class="token-detail-img" id="detailTokenImage">
                    <div class="mb-3">
                        <span class="badge rounded-pill network-badge" id="detailTokenNetwork"></span>
                    </div>
                    
                    <div class="address-container mb-4">
                        <span id="detailTokenAddress"></span>
                        <i class="fas fa-copy copy-btn" onclick="copyToClipboard('detailTokenAddress')"></i>
                    </div>
                    
                    <div class="text-start mb-4">
                        <h6 class="fw-bold">Description</h6>
                        <p id="detailTokenDescription"></p>
                    </div>
                    
                    <div class="text-start">
                        <h6 class="fw-bold">Developer</h6>
                        <p id="detailTokenCreator"></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-mwer" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Default fallback image
        const DEFAULT_TOKEN_IMAGE = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMzQ5OGRiIiBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptMCA0NDhjLTExMC41IDAtMjAwLTg5LjUtMjAwLTIwMFMxNDUuNSA1NiAyNTYgNTZzMjAwIDg5LjUgMjAwIDIwMC04OS41IDIwMC0yMDAgMjAwem02NS4yLTE0Ni40Yy0xNi4yIDAtMjAuOC0xMC44LTIwLjgtMTYuMiAwLTExLjQgMTcuNy0xMy42IDI3LjQtMTMuNiA0LjIgMCAxMS40LjUgMTUuNCAyLjEgMy4yIDEuIDYuOSAzLjkgNi45IDguNHY2My41aDE4Ljd2LTY2LjRjMC0xMy45LTcuNy0yNC44LTI3LjQtMjQuOC0xMC44IDAtMjEuMSA0LjItMjYuNyAxMC44LTIuMSAyLjYtNS45IDMuOS05LjIgMy45LTYuOSAwLTkuOS01LjItOS45LTkuMiAwLTUuOSA3LjEtMTEuNCAxOS4xLTExLjQgMTYuMiAwIDE5LjUgMTEuNCAxOS41IDE2LjIgMCAxMS40LTE3LjcgMTMuNi0yNy40IDEzLjYtNC4yIDAtMTEuNC0uNS0xNS40LTIuMS0zLjItMS02LjktMy45LTYuOS04LjR2LTYzLjVoLTE4Ljd2NjYuNGMwIDEzLjkgNy43IDI0LjggMjcuNCAyNC44IDEwLjggMCAyMS4xLTQuMiAyNi43LTEwLjggMi4xLTIuNiA1LjktMy45IDkuMi0zLjkgNi45IDAgOS45IDUuMiA5LjkgOS4yIDAgNS45LTcuMSAxMS40LTE5LjEgMTEuNHoiLz48L3N2Zz4=';

        // Sample data with reliable image data URLs
        let tokens = [
            {
                id: 1,
                name: "MWER Token",
                image: DEFAULT_TOKEN_IMAGE,
                network: "solana",
                address: "MWEKp8LkX8LkX8LkX8LkX8LkX8LkX8Lk",
                description: "The official token of MWERCOINS platform.",
                creator: "MWERCOINS Team"
            },
            {
                id: 2,
                name: "Solana MWER",
                image: DEFAULT_TOKEN_IMAGE,
                network: "solana",
                address: "7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU",
                description: "A Solana-based token for MWER community.",
                creator: "Solana MWER Team"
            },
            {
                id: 3,
                name: "Ethereum MWER",
                image: DEFAULT_TOKEN_IMAGE,
                network: "ethereum",
                address: "0x1456688345527bE1f37E9e627DA0837D6f08C925",
                description: "Ethereum version of MWER token.",
                creator: "ETH MWER Team"
            }
        ];

        // Visitor counter
        let visitorCount = localStorage.getItem('mwercoinsVisitorCount') || 0;
        visitorCount++;
        localStorage.setItem('mwercoinsVisitorCount', visitorCount);

        // Function to handle image errors
        function handleImageError(img) {
            img.src = DEFAULT_TOKEN_IMAGE;
            img.onerror = null; // Prevent infinite loop if fallback fails
            return true;
        }

        // Load tokens on page load
        document.addEventListener('DOMContentLoaded', function() {
            renderTokenList();
            document.getElementById('visitorCount').textContent = visitorCount;
            
            document.getElementById('uploadTokenBtn').addEventListener('click', uploadToken);
        });

        // Render token list with image error handling
        function renderTokenList() {
            const tokenList = document.getElementById('tokenList');
            tokenList.innerHTML = '';
            
            tokens.forEach(token => {
                const networkClass = token.network === 'solana' ? 'solana' : 
                                    token.network === 'ethereum' ? 'ethereum' : 
                                    token.network === 'bnb' ? 'bnb' : 'secondary';
                
                const tokenCard = `
                    <div class="col-md-4 mb-4">
                        <div class="card h-100" onclick="showTokenDetail(${token.id})" style="cursor: pointer;">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <img src="${token.image}" alt="${token.name}" class="token-img me-3" 
                                         onerror="handleImageError(this)">
                                    <div>
                                        <h5 class="card-title mb-0">${token.name}</h5>
                                        <span class="badge badge-network ${networkClass}">${token.network.charAt(0).toUpperCase() + token.network.slice(1)}</span>
                                    </div>
                                </div>
                                <p class="card-text text-muted">${token.description.substring(0, 80)}...</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted">By ${token.creator}</small>
                                    <button class="btn btn-sm btn-outline-primary">View</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                tokenList.innerHTML += tokenCard;
            });
        }

        // Image preview function with validation
        function previewImage(input) {
            const preview = document.getElementById('imagePreview');
            const file = input.files[0];
            
            if (!file) {
                preview.style.display = 'none';
                return;
            }

            // Validate image type
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            if (!validTypes.includes(file.type)) {
                alert('Please upload a valid image file (JPEG, PNG, GIF, or WEBP)');
                input.value = '';
                preview.style.display = 'none';
                return;
            }

            // Validate image size (max 2MB)
            if (file.size > 2 * 1024 * 1024) {
                alert('Image size must be less than 2MB');
                input.value = '';
                preview.style.display = 'none';
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        // Upload new token with image validation
        function uploadToken() {
            const tokenName = document.getElementById('tokenName').value.trim();
            const tokenNetwork = document.getElementById('tokenNetwork').value;
            const tokenAddress = document.getElementById('tokenAddress').value.trim();
            const tokenDescription = document.getElementById('tokenDescription').value.trim();
            const tokenCreator = document.getElementById('tokenCreator').value.trim();
            const tokenImageInput = document.getElementById('tokenImage');
            
            // Validate all fields
            if (!tokenName || !tokenNetwork || !tokenAddress || !tokenDescription || !tokenCreator) {
                alert('Please fill all required fields!');
                return;
            }

            let imageUrl = DEFAULT_TOKEN_IMAGE;
            
            // Handle uploaded image
            if (tokenImageInput.files && tokenImageInput.files[0]) {
                const file = tokenImageInput.files[0];
                const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
                
                if (!validTypes.includes(file.type)) {
                    alert('Invalid image format. Please upload JPEG, PNG, GIF, or WEBP.');
                    return;
                }
                
                if (file.size > 2 * 1024 * 1024) {
                    alert('Image size must be less than 2MB');
                    return;
                }
                
                imageUrl = URL.createObjectURL(file);
            }
            
            const newToken = {
                id: tokens.length + 1,
                name: tokenName,
                image: imageUrl,
                network: tokenNetwork,
                address: tokenAddress,
                description: tokenDescription,
                creator: tokenCreator
            };
            
            tokens.unshift(newToken);
            renderTokenList();
            
            // Close modal and reset form
            const modal = bootstrap.Modal.getInstance(document.getElementById('uploadModal'));
            modal.hide();
            document.getElementById('tokenForm').reset();
            document.getElementById('imagePreview').style.display = 'none';
            
            alert('Token uploaded successfully to MWERCOINS!');
        }

        // Show token detail
        function showTokenDetail(tokenId) {
            const token = tokens.find(t => t.id === tokenId);
            if (!token) return;
            
            document.getElementById('detailTokenName').textContent = token.name;
            document.getElementById('detailTokenImage').src = token.image;
            document.getElementById('detailTokenAddress').textContent = token.address;
            document.getElementById('detailTokenDescription').textContent = token.description;
            document.getElementById('detailTokenCreator').textContent = token.creator;
            
            // Set network badge
            const networkBadge = document.getElementById('detailTokenNetwork');
            networkBadge.textContent = token.network.charAt(0).toUpperCase() + token.network.slice(1);
            networkBadge.className = 'badge rounded-pill network-badge ' + 
                                  (token.network === 'solana' ? 'solana' : 
                                   token.network === 'ethereum' ? 'ethereum' : 
                                   token.network === 'bnb' ? 'bnb' : 'bg-secondary');
            
            const modal = new bootstrap.Modal(document.getElementById('tokenDetailModal'));
            modal.show();
        }

        // Copy to clipboard - FIXED VERSION
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            // Create temporary textarea
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';  // Prevent scrolling to bottom
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    const copyBtn = element.nextElementSibling;
                    copyBtn.className = 'fas fa-check copy-btn text-success';
                    setTimeout(() => {
                        copyBtn.className = 'fas fa-copy copy-btn';
                    }, 2000);
                }
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
            
            document.body.removeChild(textarea);
        }

        // Search tokens
        function searchTokens() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filteredTokens = tokens.filter(token => 
                token.name.toLowerCase().includes(searchTerm) || 
                token.description.toLowerCase().includes(searchTerm) ||
                token.creator.toLowerCase().includes(searchTerm) ||
                token.network.toLowerCase().includes(searchTerm)
            );
            
            if (searchTerm === '') {
                renderTokenList();
                return;
            }
            
            const tokenList = document.getElementById('tokenList');
            tokenList.innerHTML = '';
            
            if (filteredTokens.length === 0) {
                tokenList.innerHTML = '<div class="col-12 text-center py-5"><h4>No tokens found matching your search</h4></div>';
                return;
            }
            
            filteredTokens.forEach(token => {
                const networkClass = token.network === 'solana' ? 'solana' : 
                                    token.network === 'ethereum' ? 'ethereum' : 
                                    token.network === 'bnb' ? 'bnb' : 'secondary';
                
                const tokenCard = `
                    <div class="col-md-4 mb-4">
                        <div class="card h-100" onclick="showTokenDetail(${token.id})" style="cursor: pointer;">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <img src="${token.image}" alt="${token.name}" class="token-img me-3" onerror="handleImageError(this)">
                                    <div>
                                        <h5 class="card-title mb-0">${token.name}</h5>
                                        <span class="badge badge-network ${networkClass}">${token.network.charAt(0).toUpperCase() + token.network.slice(1)}</span>
                                    </div>
                                </div>
                                <p class="card-text text-muted">${token.description.substring(0, 80)}...</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted">By ${token.creator}</small>
                                    <button class="btn btn-sm btn-outline-primary">View</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                tokenList.innerHTML += tokenCard;
            });
        }
    </script>
</body>
</html>